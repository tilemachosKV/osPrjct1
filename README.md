# osPrjct1

# 🏛️ Αρχιτεκτονική Συστήματος

Το σύστημα βασίζεται σε ένα μοντέλο επικοινωνίας πολλών διεργασιών (Inter-Process Communication - IPC) που χρησιμοποιεί τους παρακάτω πυλώνες:

## 1. Μοντέλο Εκτέλεσης
Η εφαρμογή αποτελείται από πολλαπλές, ανεξάρτητες **Διεργασίες (Processes)**.

## 2. Εκκίνηση & Ρόλοι
Ο χρήστης εκκινεί κάθε διεργασία χειροκίνητα από τη γραμμή εντολών. Οι διεργασίες αναγνωρίζουν τον ρόλο τους μέσω παραμέτρων (flags):

* **Αρχικοποιητής (`-i`):** Η πρώτη διεργασία που εκκινείται (π.χ. `./chat -i -k key`) είναι υπεύθυνη για τη **δημιουργία** της διαμοιραζόμενης μνήμης και των δομών συγχρονισμού.
* **Συμμετέχων (`-a`):** Κάθε επόμενη διεργασία (π.χ. `./chat -a -k key`) απλώς **συνδέεται (attach)** στους ήδη υπάρχοντες πόρους.

## 3. Μέσο Επικοινωνίας
Χρησιμοποιείται **μία (1) ενιαία περιοχή Διαμοιραζόμενης Μνήμης (SHM)**, η οποία φιλοξενεί *όλους* τους ενεργούς διαλόγους ταυτόχρονα.

## 4. Ταυτόχρονη Λειτουργία
Για να επιτευχθεί η ταυτόχρονη αποστολή/λήψη, κάθε **διεργασία** θα δημιουργεί εσωτερικά **Νήματα (Threads)** (π.χ. ένα για την αναμονή εισόδου από τον χρήστη και ένα για την παρακολούθηση νέων μηνυμάτων στην SHM).

## 5. Τερματισμός Διαλόγου
Η αποστολή του μηνύματος `TERMINATE` προκαλεί τον τερματισμό *όλων* των διεργασιών που συμμετέχουν *στον συγκεκριμένο διάλογο* (αποστολέας και παραλήπτες).

## 6. Εκκαθάριση Πόρων
Ένας **κεντρικός μετρητής ενεργών διαλόγων** θα διατηρείται μέσα στην SHM. Η διεργασία που αποστέλλει το `TERMINATE` στον *τελευταίο* ενεργό διάλογο είναι υπεύθυνη για τον καθαρισμό και την αποδέσμευση της διαμοιραζόμενης μνήμης και των πόρων συγχρονισμού.

## 7. Συγχρονισμός
Η ασφαλής ταυτόχρονη πρόσβαση στην SHM (π.χ. στον μετρητή διαλόγων, στις εγγραφές μηνυμάτων) θα διασφαλιστεί με κατάλληλους μηχανισμούς συγχρονισμού, όπως οι **Σημαφόροι (Semaphores)**.

---

# 🐞 Έλεγχος & Debugging

## 1. Έλεγχος Πόρων Συστήματος (ipcs / ipcrm)

### `ipcs`: Έλεγχος Ενεργών Πόρων

* **Έλεγχος Διαμοιραζόμενης Μνήμης (SHM):**
    ```bash
    ipcs -m
    ```
* **Έλεγχος Σημαφόρων (Semaphores):**
    ```bash
    ipcs -s
    ```
### `ipcrm`: Χειροκίνητος Καθαρισμός

* **Καθαρισμός Μνήμης**
    ```bash
    ipcrm -m <shmid>
    ```

* **Καθαρισμός Σημαφόρων**
    ```bash
    ipcrm -s <semid>
    ```

## 2. Έλεγχος Private Μνήμης & Leaks (Valgrind Memcheck)

**Χρήση:**
```bash
valgrind --leak-check=full ./chat -a -k 1234